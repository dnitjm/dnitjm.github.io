$(document).ready(function(){function e(e,t){var i=$(this).closest(".line").next(".es-list").find(".selected"),s=i.data(e),l=i.data(t),n=$(this).closest(".dropdown").siblings(".datainputs");n.find(":first-child").val(s),n.find(":last-child").val(l)}function t(e,t){var i=$(this).closest("fieldset").find(".line").length,s=$(this).closest("fieldset");if(i>1){$(this).closest(".line").remove();var l=1;s.find(".input_name").each(function(){$(this).attr("placeholder",e+" #"+l),l+=1})}else{s.find("input").val("");var n=$(this).closest("fieldset").find(t);console.log(n),n.addClass("remove-off").removeClass("remove-choose"),n.html("-").css("background","red"),n.closest("fieldset").find(".fieldset_container button").addClass("btn_add").html("+").removeClass("btn_remove"),n.closest(".textrow").siblings(".fieldset_container").removeClass("fieldset_container-active")}}$("#standard").editableSelect({filter:!1,effects:"slide",onSelect:function(t){e.call(this,"standby","duty")}}),$("#amplifier_1").editableSelect({filter:!1,effects:"slide",onSelect:function(){e.call(this,"qpower","dcpower")}}),$("body").on("click","#fieldset_amplifiers .btn_add",function(){var t=$(this).closest("fieldset"),i=$(this).closest(".line").clone();t.find(".es-list:last-of-type").after(i);var s=t.find(".line:last-of-type").find(".dropdown"),l=t.find(".line").length;s.find("input").remove(),s.find("select").attr("id","amplifier_"+l).editableSelect({filter:!1,effects:"slide",onSelect:function(t){e.call(this,"qpower","dcpower")}}).css("display","inline-block"),s.siblings(".datainputs").find("input").each(function(){$(this).val("")}),s.siblings(".amplifier_name").find("input").val("").attr("placeholder","Amplifier #"+l)}),$("body").on("click","#fieldset_otheritems .btn_add",function(){var e=$(this).closest("fieldset"),t=$(this).closest(".line").clone();e.find(".fieldset_container").append(t);var i=e.find(".line").length,s=e.find(".line:last-of-type");s.find('input[type="text"]').val("").attr("placeholder","Item #"+i),s.find('input[type="number"]').val("")}),$("#calculate").on("click",function(e){e.preventDefault(),$(".error, #result_inv, #result_bat").html("");var t=0;$(".amplifiers_data-dcpower").each(function(){t+=parseInt($(this).val())});var i=0;$(".amplifiers_data-qpower").each(function(){i+=parseInt($(this).val())});var s=0;$(".otheritem_value").each(function(){s+=parseInt($(this).val())});var l=parseInt($("#standard_data-standby").val()),n=parseInt($("#standard_data-duty").val())/60,a=parseInt($("#voltage").val()),o=parseInt($("#error_margin").val())/100;if(isNaN(t)||isNaN(i)||isNaN(s)||isNaN(l)||isNaN(n)||isNaN(a)||isNaN(o))$(".error").html("Please fill in all the fields");else{var d=1.2*(t/8+s)/a,r=(i+s)/a*l,c=(t/8+s)/a*n,f=r+c,h=(d+d*o).toFixed(3),v=(f+f*o).toFixed(3);$("#result_inv").html(h+" VA"),$("#result_bat").html(v+" AH")}}),$("body").on("click","#fieldset_amplifiers .btn_remove",function(){var e=$(this).closest("fieldset").find(".line").length;e>1&&$(this).closest(".line").next(".es-list").remove()}),$("body").on("click","#fieldset_amplifiers .btn_remove",function(){t.call(this,"Amplifier","#remove_amplifier")}),$("body").on("click","#fieldset_otheritems .btn_remove",function(){t.call(this,"Item","#remove_otheritem")}),$("#remove_amplifier, #remove_otheritem").on("click",function(){$(this).hasClass("remove-off")?($(this).addClass("remove-choose").removeClass("remove-off"),$(this).html("+").css("background","#49E20E"),$(this).closest("fieldset").find(".fieldset_container button").addClass("btn_remove").html("-").removeClass("btn_add"),$(this).closest(".textrow").siblings(".fieldset_container").addClass("fieldset_container-active")):($(this).addClass("remove-off").removeClass("remove-choose"),$(this).html("-").css("background","red"),$(this).closest("fieldset").find(".fieldset_container button").addClass("btn_add").html("+").removeClass("btn_remove"),$(this).closest(".textrow").siblings(".fieldset_container").removeClass("fieldset_container-active"))})});